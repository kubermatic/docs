+++
title = "Your First Service"
weight = 2
+++

A "service" in KDP defines a unique Kubernetes API Group and offers a number of resources (types) to
use. A service could offer certificate management, databases, cloud infrastructure or any other set
of Kubernetes resources.

Services are provided by service owners, who run their own Kubernetes clusters and take care of the
maintenance and scaling tasks for the workload provisioned by all users of the service(s) they
offer.

A KDP Service should not be confused with a Kubernetes Service. Internally, a KDP Service is
ultimately translated into a kcp `APIExport` with a number of `APIResourceSchemas` (~ CRDs).

## Scope

This document describes the process of setting up a new Service from scratch, from the standpoint
of a Service Owner. See [Using Services]({{< relref "../../platform-users/consuming-services" >}})
for more information from the standpoint of Service Consumers (i.e. endusers).

## Creating Services

Login to the KDP Dashboard and navigate to the organization where the Service should be available
(generally, Services can be consumed from any other workspace). Choose the "Create Service" option.

To define a new service you must choose (i.e. make up) a unique API Group and can then also specify
a more descriptive name and a short description for your service. All of these will help platform
users find and consume the service later.

This concludes all required steps to define the new service. Click on the confirm button to create
the Service.

## Setting up the Servlet

Once the service is created, KDP will provision a kubeconfig. This kubeconfig is meant to be used
by the KDP Servlet, the component installed by service owners into the service cluster.

(TODO: Make this kubeconfig available via the KDP Dashboard.) You can also use `kubectl` to navigate
into your workspace and inspect your Service object. In `spec.kubeconfig` you will find the name of
the kubeconfig Secret that you can use for your Servlet.

Now switch your focus to your own cluster, where your business logic happens (for example where
Crossplane runs). For your Service you need to provide exactly _one_ Servlet in _one_ Kubernetes
cluster. This Servlet can have multiple replicas as it uses leader election, but you must not have
two or more independent Servlets processing the same Service. There is currently no mechanism to
spread load between multiple Service clusters and two or more Servlets will most likely conflict
with each other.

The Servlet comes as a Helm chart. See `deploy/charts/servlet` for more information. You basically
need to provide the kubeconfig generated by KDP as the "platform kubeconfig", the service's name
(not its API Group) and a unique name for the Servlet itself. Put all the information in a
`values.yaml` and run `helm install` to deploy your Servlet.

Once the Servlet has booted up, it will just sit there and do nothing, waiting for further
configuration.

## Defining Published Resources

Once the Servlet is up and running, you have to create `PublishedResource` objects on the service
cluster. See the documentation for
[publishing resources]({{< relref "../../service-providers/publish-resources" >}}) for more
information.

The Servlet will automatically react to `PublishedResources` and begin replicating them into KDP/kcp.
This means setting up an `APIExport` and `APIResourceSchemas`. Once this is done, the KDP Service
can actually be consumed on the platform. See
[Using Services]({{< relref "../../platform-users/consuming-services" >}}) for more information.
